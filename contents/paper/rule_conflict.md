---
layout: distill-reading
bibliography: all.bib
giscus_comments: false
disqus_comments: false
date: 2025-12-22
featured: true
img: assets/img/feigenbaum.png
title: 'Rule Conflict'
category: 'AI'
description: ''
_styles: >
    table {
        padding-top: 200px;
        margin-bottom: 2.5rem;
        border-bottom: 2px;
        width: 120%;
        margin-left: -10%;
        margin-right: -10%;
        table-layout: fixed;
    }
    .table {
        padding-top: 200px;
        margin-bottom: 2.5rem;
        border-bottom: 2px;
        width: 120%;
        margin-left: -10%;
        margin-right: -10%;
        table-layout: fixed;
    }
    .p {
        font-size: 20px;
        font-weight: 250;
    }
    .styled-image {
        border-radius: 15px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        margin: 20px auto;
        transition: transform 0.3s ease;
        display: block;
    }
    .styled-image:hover {
        transform: scale(1.2);
    }
    td, th {
        font-size: 1.10rem;
        font-family: 'Times New Roman', Times, serif;
    }
---


- **General Conflict** 
- **Knowledge Conflict** 
- **Proposition Interpretation Confclit** 
- **Rule Interpretation Confclit** 


## General Conflict

충돌(conflict)이란 두 개 이상의 믿음이 동시에 유지될 때, 그들 사이에 **불일치**가 발생하는 상황을 의미한다.  
가장 단순한 형태는 두 믿음 간의 충돌이지만, 상황에 따라 세 개 혹은 그 이상의 믿음들이 상호작용하며 충돌을 일으킬 수도 있다.

임의의 믿음 $\mathcal{B}$에 대해 또 다른 믿음 $\tilde{\mathcal{B}}$가 불일치한다는 것은 여러 방식으로 정의될 수 있다.  
논리적 관점에서는, 두 믿음을 동시에 받아들일 경우 모순이 도출되는 상황으로 이를 표현할 수 있다.

$$
\{ 
 \mathcal{B}, \tilde{\mathcal{B}} 
\} \models \perp
$$

다만, 이러한 개념은 종종 다음과 같은 단순한 차이(difference)와 혼동된다.

$$
\mathcal{B} \neq \tilde{\mathcal{B}}
$$

이는 두 믿음이 서로 **다르다**는 사실만을 나타낼 뿐이다.  
그러나 다르다는 것이 곧 충돌을 의미하지는 않는다. 예를 들어, **춥다**와 **쌀쌀하다**는 서로 다른 표현이지만, 의미적으로 충돌하지 않는다.  
이처럼 충돌은 단순한 차이를 넘어, 믿음들 사이의 **상호작용과 긴장**을 포함하는 보다 역동적인 개념이다.

또한, 논리적 모순의 도출은 충돌을 설명하는 **충분조건**일 수는 있지만, **필요조건**은 아니다.  
모든 믿음이 명시적인 논리 형식으로 표현되는 것은 아니며, 설령 논리적으로 표현되더라도, 지식 베이스 내에서 규칙의 적용 과정에서 모순이 발생하는 경우, 충돌은 개별 믿음들 사이가 아니라 **믿음에 적용된 추론 결과들 사이**에서 발생하기도 한다.

따라서 두 믿음 간의 충돌은 상황과 맥락에 따라 다르게 정의되어야 하며, 궁극적으로 **충돌이라는 개념 자체는 정의 방식에 의존한다**고 볼 수 있다.

그럼에도 불구하고, 일반적으로 충돌이 갖는 성질을 정리하면 다음과 같다.

- 적어도 두 개 이상의 서로 다른 믿음이 존재해야 한다.  
- 믿음들이 해석되고 상호작용하는 환경이 필요하다.  
- 해당 환경 내에서, 믿음들로부터 **충돌이라는 판단**이 유도된다.

이러한 관점에서 보면, 충돌 역시 하나의 믿음으로 이해할 수 있다.  
즉, 충돌은 모순적인 상황이나 시스템의 불확실성을 드러내는 **메타-수준의 믿음**이다.

이를 논리적 표기법을 차용해 표현하면 다음과 같이 쓸 수 있다.

$$
\{ 
 \mathcal{B}, \tilde{\mathcal{B}} \mid \mathcal{E}
\} \models \mathcal{C}
$$

여기서 $\models$는 엄밀한 의미의 논리적 함의라기보다는, **해석적 결과를 나타내는 기호**로 이해할 수 있다.

예를 들어,  
“메시는 축구를 한다”와 “메시는 농구를 한다”라는 두 믿음은 그 자체로 항상 충돌하지는 않는다.  
이 둘이 충돌하게 되는 것은, *메시라는 인물이 특정 시점에서 하나의 직업적 역할만을 가질 수 있다*는 제약이 환경 $\mathcal{E}$에 포함될 때이다.  
즉, 충돌은 믿음 그 자체보다도, **믿음이 놓이는 환경과 그 환경이 강제하는 제약**에 의해 발생한다.

이는 상식(common sense)이 명시적으로 작동하는 사례로 볼 수 있으며, 지식의 충돌은 단순한 불일치를 넘어,  
서로 다른 믿음과 그들이 해석되는 환경의 차이에서 비롯된다.

더 나아가, 만약 환경 $\mathcal{E}$ 자체가 믿음을 제공한 주체에 따라 달라진다면, 문제는 다음과 같이 표현될 수 있다.

$$
\{ 
 \mathcal{B}, \tilde{\mathcal{B}} \mid \mathcal{E}, \tilde{\mathcal{E}}
\} \models \mathcal{C}
$$

실제로는 각 믿음이 서로 다른 환경을 전제하는 경우가 많으며, 이때 충돌은 각각의 환경에서 독립적으로 판단된다.

$$
\{ 
 \mathcal{B}, \tilde{\mathcal{B}} \mid \mathcal{E}
\} \models \mathcal{C},
\quad 
\{ 
 \mathcal{B}, \tilde{\mathcal{B}} \mid \tilde{\mathcal{E}}
\} \models \mathcal{C}
$$

결국, 충돌은 지식 자체의 불일치라기보다는, **환경 내에서 충돌을 어떻게 정의하고 해석하느냐**에 의해 결정된다.  
사람들은 각자 서로 다른 환경을 가정하고 믿음을 해석하기 때문에, 어떤 이에게는 충돌이 발생하지만, 다른 이에게는 그렇지 않을 수 있다.

따라서 충돌을 다루기 위해서는,  
먼저 환경을 명시적으로 설정하고, 그 환경 하에서 믿음을 해석하며, 충돌을 정의하는 방식이 필요하다.


## Proposition Interpretation Conflict 

가장 기본적인 형태의 충돌은 **명제를 정의하고, 그 명제를 참 또는 거짓으로 평가하는 과정**에서 발생한다.  
예를 들어, LLM에게 *“짧게 대답하라”*는 instruction을 주었는데, 실제 생성 과정에서는 긴 답변을 생성했다면,  
이는 생성물에 대한 평가가 instruction과 **충돌**하는 상황으로 볼 수 있다.

이 경우 핵심은, LLM에게 부과된 제약(constraint)에 대해 **참/거짓을 평가할 수 있는 기준이 존재한다는 점**이다.  
그리고 그 제약을 만족하거나 위반하는 여부에 따라 충돌이 정의된다.

임의의 constraint $Q$가 LLM에게 주어졌다고 하자.  
$Q$ 또는 $\neg Q$ 중 어느 쪽이 참인지 평가할 수 있다고 가정할 때,  
만약 동일한 상태에서 $Q$와 $\neg Q$가 **동시에 성립**한다면, 이는 명제 수준에서의 모순이며,  
상태는 해당 명제에 대해 충돌하고 있다고 볼 수 있다.

중요한 점은, 단순히 명제가 충돌하는지 여부보다도  
**명제를 어떻게 해석하고, 어떤 방식으로 진리값을 할당하는가**이다.  
즉, 충돌은 명제 자체가 아니라, 명제를 해석하는 규칙과 평가 과정에서 발생한다.

이를 일반화하면 다음과 같다.  
주어진 LLM 모델에 대해 임의의 명제 $Q$를 정의하고,  
상태 $X$에 대해 $Q(X)$의 진리값을 평가하는 규칙을 설정한다.  
만약 동일한 $X$에 대해 $Q(X)$가 참이면서 동시에 거짓으로 유도된다면,  
이는 명제 해석 수준에서의 충돌이다.

예를 들어, instruction으로 *“대문자를 사용하라”*는 제약을 주었다고 하자.  
이는 $Q =$ “대문자로 생성한다”라는 명제로 표현될 수 있다.  
그런데 생성 결과에서 소문자가 포함된다면, 이는 $\neg Q$가 동시에 유도된 것으로 볼 수 있다.

다만, *“대문자를 사용하라”*와 *“소문자를 사용하라”*는 지시가  
항상 곧바로 충돌로 정의되는 것은 아니다.  
예를 들어 **Apple**이라는 단어는 대문자와 소문자를 모두 포함하고 있기 때문이다.  
즉, 이 경우 명제의 정의가 충분히 명확하지 않다.

따라서 충돌을 명확히 정의하기 위해서는 제약을 더 정밀하게 명제화해야 한다.  
예를 들어 다음과 같이 정의할 수 있다.

- $P =$ “첫 문자는 반드시 대문자이다”
- $Q =$ “첫 문자는 반드시 소문자이다”

이 경우  
$P \Rightarrow \neg Q$,  
$Q \Rightarrow \neg P$  
가 성립하므로, 동일한 생성 결과가 $P$와 $Q$를 동시에 만족한다면 모순이 유도된다.

이처럼 명제적 지시사항 간의 충돌은  
**하나의 명제를 만족했을 때, 다른 명제의 진리값이 자동으로 부정되는 구조**를 가질 때 명확해진다.  
보다 단순한 형태는 다음과 같다.

- 첫 문자를 대문자로 써라.
- 첫 문자를 대문자로 쓰지 마라.

여기서는 대문자 사용 여부가 참/거짓으로 명확히 구분되며,  
두 명제는 직접적인 부정 관계에 있다.

반대로, 명시적인 부정이 포함되지 않은 경우에는 해석의 여지가 생긴다.  
따라서 LLM에 대해 두 개의 instruction이 충돌한다고 주장하려면,  
**두 번째 instruction이 첫 번째 instruction의 부정을 유도하기에 충분한지**,  
즉 명제 수준에서 $\neg$ 관계가 성립하는지를 반드시 확인해야 한다.


## Rule Interpretation Conflict

논리적 추론에서 규칙(rule)에 의해 새로운 믿음(belief)을 획득할 때, 서로 다른 규칙 적용 결과가 충돌하는 상황이 발생할 수 있다. 예를 들어 다음과 같은 두 규칙을 생각하자.

$$
\mathcal{D} \rightarrow \mathcal{B}, \quad \mathcal{E} \rightarrow \neg \mathcal{B}
$$

서로 다른 트리거 $\mathcal{D}$와 $\mathcal{E}$가 각각 활성화될 경우, 도출되는 결론 $\mathcal{B}$와 $\neg \mathcal{B}$는 상호 충돌한다.  
이때 이러한 충돌은 단순한 명제 수준의 충돌을 넘어, **규칙의 활성화 자체가 만들어내는 충돌**로 이해할 수 있다. 즉, 규칙 활성화에 의한 충돌은 $\mathtt{t} \rightarrow \mathcal{B}$ 형태의 명제 충돌을 포함하는 보다 상위 개념이다.

조건에 의해 발생하는 이러한 충돌을 해소하기 위해서는, 규칙의 적용을 **철회(retraction)** 할 수 있어야 한다.  
규칙을 철회한다는 것은 규칙의 적용 사실 또는 그 결과를 더 이상 수용하지 않겠다는 의미이며, 이에 대해 다음과 같은 세 가지 해석이 가능하다.

1. **소극적 철회 (Rollback)**  
   규칙을 철회하면서 믿음을 적용 이전 상태 $\mathcal{B}_0$로 되돌린다. 이는 해당 규칙의 적용 자체가 부적절했음을 가정하고, 이전 상태로 복구하는 방식이다.  
   그러나 규칙 적용 이후 다른 규칙이나 시간적 요인에 의해 믿음이 추가로 변경되었다면, 단순 복구는 올바른 해결책이 아닐 수 있다.

2. **적극적 철회 (Negation Acceptance)**  
   규칙을 철회하면서 결론 믿음에 대한 부정, 즉 $\neg \mathcal{B}$를 수용한다. 이는 기존 믿음을 명시적으로 부정하는 방식으로, 보다 공격적이고 강한 형태의 철회라 볼 수 있다.

3. **대범적 철회 (Result Preservation)**  
   규칙의 적용 사실만 제거하고, 결론 믿음 $\mathcal{B}$ 자체는 유지한다. 이는 규칙이 결론을 *설명*하는 역할만 했을 뿐, 결론의 정당성 자체에는 관여하지 않는다는 해석이다.  
   실세계에서 사후적으로 근거를 정리하는 설명 방식과 유사하며, 이 경우 규칙은 계산 결과의 논리적 설명을 위해 존재하게 된다.


규칙 간 충돌은 결국 **결론에 도달하는 경로들 간의 충돌**이다. 규칙들이 서로 독립적으로 작성되고 명시적 제약이 없을 경우, 다음과 같은 구조적 문제가 발생할 수 있다.

- $\mathcal{A} \rightarrow \mathcal{D}, \; \mathcal{D} \rightarrow \mathcal{B}$
- $\mathcal{A} \rightarrow \mathcal{E}, \; \mathcal{E} \rightarrow \neg \mathcal{B}$

이는 동일한 조건 $\mathcal{A}$로부터 $\mathcal{B}$와 $\neg \mathcal{B}$가 동시에 도출되는 상황이다. 이를 지식베이스 형태로 나열하면 다음과 같다.

$\mathbf{KB}$:
- $\mathcal{A} \rightarrow \mathcal{D}$
- $\mathcal{D} \rightarrow \mathcal{B}$
- $\mathcal{A} \rightarrow \mathcal{E}$
- $\mathcal{E} \rightarrow \neg \mathcal{B}$

논리적 추론이 가능한 시스템이라면, 이러한 구조에서 **결론 수준의 충돌이 발생했음을 인지**할 수 있어야 한다.

이와 같은 논리적 모순은 여러 이유로 발생한다. 대표적으로 다음과 같다.

1. **Normality 기반 규칙 작성**  
   일반적인 상황을 가정해 규칙을 작성했으나, 예외적 상황을 별도의 규칙으로 추가하면서 충돌이 발생하는 경우.

2. **부정(negation)의 정의 불충분성**  
   예를 들어 “농구를 한다”를 “축구를 한다”의 부정으로 볼 수 있는지와 같은 문제는 부정의 의미를 명확히 정의하지 않으면 충돌을 야기한다.

이러한 충돌은 자연스러운 현상일 수 있다. 만약 세계의 상태가 유일하게 결정되어야 한다면, 즉 모든 명제의 진리값을 하나로 결정해야 하는 **고전적 2값 논리**를 따른다면, 충돌은 반드시 해소되어야 한다. 
반면, Kleene 논리나 Belnap 논리처럼 명제에 대해 다중 진리값을 허용하는 경우에는, **충돌 상태 자체가 자연스러운 중간 상태**로 받아들여질 수 있다. 물론 이 경우에도 최종적인 진리값을 결정하는 문제는 여전히 어려운 과제로 남는다.



--- 


기존의 Knowledge Conflict 연구들은 대체로 명제의 상태를 중심으로 충돌을 정의해왔다. 즉, 특정 명제 $Q$가 참인지 혹은 거짓인지($Q$ or $\neg Q$)를 구분하고, 모델이 attention이나 제약(constraint)을 통해 해당 상태를 만족하도록 유도하는 방식이다. 이때 conflict는 제약 조건 간의 불일치로 다뤄지며, 주된 목적은 모델의 상태(state)를 교정하는 데 있다.

그러나 LLM의 생성은 본질적으로 조건적이며, conflict는 단순한 상태의 불일치가 아니라 implication을 통한 추론 과정에서 도출되어야 한다. 예를 들어 다음과 같은 규칙을 고려하자.
해로운 요청이 주어질 경우 거절한다는 규칙은 $A \rightarrow B$로 표현할 수 있다.

이때 $A$가 성립하지 않는 경우에는 $B$가 유도되지 않는 것이 자연스럽다. 더 나아가, 특정한 요청에 대해 거절하지 않는다는 규칙이 $C \rightarrow \neg B$로 주어진다고 하자. 모델에게 $A$와 $C$가 각각 주어졌을 때, 두 규칙 중 하나를 선택하여 $B$ 혹은 $\neg B$를 산출했다면, 이는 규칙에 따른 조건적 선택으로 해석할 수 있으며 이를 곧바로 conflict라고 정의할 수는 없다.

반면, 모델이 $A$와 $C$가 동시에 성립한다는 사실을 인지하고 있다면, 상황은 달라진다. 이 경우 모델은 동일한 결론에 대해 상반된 결과를 유도하는 두 implication 규칙이 충돌한다는 사실을 인식해야 하며, 그 결과로 $B$와 $\neg B$ 중 어느 것도 단정할 수 없다는 판단에 도달할 수도 있다.

따라서 implication 기반 규칙 적용에서 conflict는 단순히 positive 혹은 negative polarity를 선택했는지로 정의될 수 없다. 모델이 조건에 따라 추론을 분기하여 적절한 결론을 산출했다면 이는 정상적인 추론 결과이며, 특정 polarity를 선택했다는 사실만으로 conflict가 발생했다고 볼 수는 없다.

하지만 동일한 전제에 대해 상반된 결론을 직접적으로 유도하는 규칙, 즉 $A \rightarrow B$와 $A \rightarrow \neg B$가 동시에 주어진 경우에는 명확한 논리적 충돌이 발생한다. 이때 모델은 두 규칙이 서로 양립 불가능하다는 사실을 인식해야 한다.

더 복잡한 추론 구조를 고려해보자. 예를 들어 $A \rightarrow C \rightarrow B$, $\neg A \rightarrow C \rightarrow \neg B$, 그리고 $\rightarrow C \rightarrow \neg B$와 같은 규칙들이 주어진 경우, 모델은 현재 어떤 전제가 성립한다고 가정하고 있는지, 그에 따라 어떤 규칙이 활성화되는지, 그리고 그 과정에서 규칙 간 충돌이 발생하는지를 명시적으로 구분할 수 있어야 한다.

결과적으로, 모델이 현재 가정하고 있는 상태와 그로 인해 선택된 규칙, 그리고 해당 규칙 집합 내에서의 충돌 여부를 분간하는 능력은 주어진 조건들과 그로부터 도출되는 추론 결과 사이의 conflict를 명시적으로 파악하는 데 핵심적이다.

이에 본 연구에서는 규칙 전이와 초기 사실들이 주어졌을 때, 모델이 규칙 기반 추론을 수행하여 주어진 질의에 대해 참 또는 거짓을 정확히 판별할 수 있는지를 살핀다. 더 나아가, 규칙 집합 자체에 모순이 존재하는 경우 모델이 이를 단순한 오답이 아닌 명시적인 conflict로 인식하고 표현할 수 있는지를 분석한다.

우리는 이러한 능력을 논리 명제 수준에서의 conflict에 대한 기초적 이해라고 정의하며, 본 연구는 LLM의 해당 이해 수준을 체계적으로 평가하고 이를 개선하기 위한 방법론을 제안한다.

---


1. LLM은 충돌이 발생했음을 인지하는가?  
   $Q$와 $\neg Q$의 동시 성립에 대한 인식  
   (명시적 동시 발현에 대한 이해)

2. LLM은 조건에 따라 서로 다른 형태의 충돌을 구분하는가?  
   $A \rightarrow Q$ 와 $B \rightarrow \neg Q$  
   (조건 차이에 따른 결론 부정의 구분)

3. LLM은 premise negation에 대해 적절히 반응하는가?  
   $A \rightarrow Q$ 와 $\neg A \rightarrow \neg Q$  
   (동일한 premise atom에 대한 부정 구분)

4. 규칙 내부에 명시적으로 드러나지 않는 충돌을 인지하는가?  
   $A \rightarrow C$ 그리고 $C \rightarrow Q$,  
   $B \rightarrow D$ 그리고 $D \rightarrow \neg Q$  
   이 경우 premise는 다르지만, 다단계 추론(multi-hop reasoning)을 통해
   동일한 결론 $Q$와 $\neg Q$가 유도되며,
   이는 추론 경로 수준에서 발생하는 충돌에 해당한다.

기존 연구들은 주로 1번과 같이 $Q$와 $\neg Q$가 명시적으로 동시에 주어지는 경우의
충돌만을 다뤄왔다. 그러나 실제 LLM의 추론 능력을 평가하기 위해서는,
조건에 따라 논리를 명확히 추론하고, 서로 다른 충돌 유형을 구분하는 능력을
체계적으로 분석할 필요가 있다.

이에 본 연구에서는 다음을 수행한다.
1. LLM의 충돌 인식 및 구분 능력을 정량적으로 평가한다.
2. Fine-tuning을 통해 이러한 능력이 어느 정도까지 개선되는지를 분석한다.
3. External Rule Manager를 도입하여, 규칙 기반 추론 하에서의 belief 관리 및
   충돌 대응 메커니즘을 탐구한다.

| 도메인 | 기준 A (A → B) | 기준 C (C → ¬B) | B의 의미 | 왜 자연스러운가 |
|---|---|---|---|---|
| **제품 품질 평가** | 성능 점수가 기준 이상이면 우수하다 | 안정성 테스트 실패 시 우수하지 않다 | 제품이 “우수함” | 성능과 안정성은 독립적인 품질 기준 |
| **논문 심사** | 연구 기여도가 높으면 채택 추천 | 윤리 위반이 있으면 채택 불가 | 논문 채택 여부 | 학술적 가치 vs 윤리 기준 |
| **의료 진단** | 임상 증상이 명확하면 질병 의심 | 검사 결과가 음성이면 질병 아님 | 질병 존재 여부 | 증상 기반 판단 vs 검사 기반 판단 |
| **시스템 배포 결정** | 기능 테스트 통과 시 배포 가능 | 보안 점검 실패 시 배포 불가 | 배포 가능 여부 | 기능 완성도 vs 보안 기준 |
| **채용 평가** | 기술 인터뷰 우수 시 합격 추천 | 문화 적합성 낮으면 불합격 | 채용 여부 | 기술 역량 vs 조직 적합성 |
| **추천 시스템** | 사용자 만족도 예측 높음 → 추천 | 부작용 위험 높음 → 비추천 | 추천 여부 | 효용 극대화 vs 리스크 최소화 |
| **신용 평가** | 소득 안정적이면 대출 승인 | 연체 기록 있으면 대출 거절 | 대출 승인 여부 | 상환 능력 vs 신용 이력 |
| **자율 시스템 판단** | 주행 성능 정상 → 자동 모드 유지 | 센서 신뢰도 낮음 → 자동 모드 해제 | 자동 모드 유지 여부 | 제어 성능 vs 정보 신뢰성 |

```
{
  "atoms": {
    "A": "High performance criterion is satisfied",
    "B": "Safety or stability criterion is violated",
    "C": "The product is technically excellent",
    "D": "The product is high-risk",
    "Q": "The product should be approved"
  },

  "cases": {
    "1_explicit_conflict": {
      "facts": [],
      "rules": [
        "If true, then {Q}.",
        "If true, then ~{Q}."
      ]
    },

    "2_condition_based_conflict": {
      "facts": ["{A}", "{B}"],
      "rules": [
        "If {A}, then {Q}.",
        "If {B}, then ~{Q}."
      ]
    },

    "3_premise_negation": {
      "facts": ["~{A}"],
      "rules": [
        "If {A}, then {Q}.",
        "If ~{A}, then ~{Q}."
      ]
    },

    "4_multi_hop_reasoning_conflict": {
      "facts": ["{A}", "{B}"],
      "rules": [
        "If {A}, then {C}.",
        "If {C}, then {Q}.",
        "If {B}, then {D}.",
        "If {D}, then ~{Q}."
      ]
    }
  }
}
```